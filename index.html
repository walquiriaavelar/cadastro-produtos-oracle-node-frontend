<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Cadastro de Produto</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script defer src="app.js"></script>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center">
  <div class="bg-white p-8 rounded shadow-md w-full max-w-md">
    <h1 class="text-2xl font-bold mb-6">Cadastro de Produto</h1>
    <form id="product-form" class="space-y-4">
      <div>
        <label for="name" class="block font-medium">Nome</label>
        <input type="text" id="name" class="w-full border p-2 rounded" required>
      </div>
      <div>
        <label for="price" class="block font-medium">Pre√ßo</label>
        <input type="number" id="price" class="w-full border p-2 rounded" step="0.01" required>
      </div>
      <div>
        <label for="quantity" class="block font-medium">Quantidade</label>
        <input type="number" id="quantity" class="w-full border p-2 rounded" required>
      </div>
      <button type="submit" class="bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700">
        Salvar
      </button>
    </form>
    <p id="message" class="mt-4 text-center text-sm text-green-600 hidden"></p>
  </div>
</body>
</html>
<hr>
<h2>Produtos Cadastrados</h2>
<button onclick="listarProdutos()">üîÑ Atualizar lista</button>
<ul id="lista-produtos" class="mt-2 list-disc pl-6"></ul>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const form = document.getElementById("product-form");
    const mensagem = document.getElementById("message");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      const produto = {
        nome: document.getElementById("name").value,
        preco: parseFloat(document.getElementById("price").value),
        quantidade: parseInt(document.getElementById("quantity").value)
      };

      try {
        const res = await fetch('http://localhost:3000/mensagem', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(produto)
        });

        const json = await res.json();
        console.log("Resposta da API:", json);

        mensagem.textContent = "‚úÖ Produto enviado com sucesso!";
        mensagem.classList.remove("hidden");
        mensagem.classList.remove("text-red-600");
        mensagem.classList.add("text-green-600");

      } catch (err) {
        console.error("Erro:", err);
        mensagem.textContent = "‚ùå Erro ao enviar o produto.";
        mensagem.classList.remove("hidden");
        mensagem.classList.remove("text-green-600");
        mensagem.classList.add("text-red-600");
      }
    });
  });
</script>
<script>
  async function listarProdutos() {
    try {
      const res = await fetch('http://localhost:3000/produtos');
      const produtos = await res.json();

      const lista = document.getElementById('lista-produtos');
      lista.innerHTML = '';

      produtos.forEach(prod => {
        const item = document.createElement('li');
        item.textContent = `üõí ${prod.nome} - R$ ${prod.preco} (${prod.quantidade} un.)`;
        lista.appendChild(item);
      });
    } catch (err) {
      console.error('Erro ao buscar produtos:', err);
      alert('‚ùå N√£o foi poss√≠vel carregar os produtos.');
    }
  }
</script>
